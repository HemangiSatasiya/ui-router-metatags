{"version":3,"sources":["/source/ui-router-metatags.ts","ui-router-metatags.js"],"names":["uiroutermetatags","uiroutermetatags.runBlock","uiroutermetatags.runBlock.stateChangeStart","uiroutermetatags.runBlock.stateChangeSuccess","uiroutermetatags.runBlock.stateChangeError","uiroutermetatags.runBlock.stateNotFound","uiroutermetatags.UIRouterMetatags","uiroutermetatags.UIRouterMetatags.constructor","uiroutermetatags.UIRouterMetatags.setTitlePrefix","uiroutermetatags.UIRouterMetatags.setTitleSuffix","uiroutermetatags.UIRouterMetatags.setDefaultTitle","uiroutermetatags.UIRouterMetatags.setDefaultDescription","uiroutermetatags.UIRouterMetatags.setDefaultKeywords","uiroutermetatags.UIRouterMetatags.setStaticProperties","uiroutermetatags.UIRouterMetatags.setOGURL","uiroutermetatags.UIRouterMetatags.$get","uiroutermetatags.MetaTags","uiroutermetatags.MetaTags.constructor","MetaTags","$inject","uiroutermetatags.MetaTags.update","uiroutermetatags.MetaTags.getValue","runBlock"],"mappings":"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","file":"ui-router-metatags.min.js","sourcesContent":["namespace uiroutermetatags {\r\n\tconst appModule = angular.module('ui.router.metatags', ['ui.router']);\r\n\r\n\texport class UIRouterMetatags implements angular.IServiceProvider, uiroutermetatags.IProvider {\r\n\t\tprefix: string = '';\r\n\t\tsuffix: string = '';\r\n\t\tdefaultTitle: string = '';\r\n\t\tdefaultDescription: string = '';\r\n\t\tdefaultKeywords: string = '';\r\n\t\tstaticProperties: {} = {};\r\n\t\tenableOGURL: boolean = false;\r\n\r\n\t\t/* @ngInject */\r\n\t\tconstructor() {\r\n\r\n\t\t}\r\n\r\n\t\tsetTitlePrefix(prefix: string): UIRouterMetatags {\r\n\t\t\tthis.prefix = prefix;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tsetTitleSuffix(suffix: string): UIRouterMetatags {\r\n\t\t\tthis.suffix = suffix;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tsetDefaultTitle(title: string): UIRouterMetatags {\r\n\t\t\tthis.defaultTitle = title\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tsetDefaultDescription(description: string): UIRouterMetatags {\r\n\t\t\tthis.defaultDescription = description;\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tsetDefaultKeywords(keywords: string): UIRouterMetatags {\r\n\t\t\tthis.defaultKeywords = keywords;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tsetStaticProperties(properties: {}): UIRouterMetatags {\r\n\t\t\tthis.staticProperties = properties;\r\n\t\t\treturn this;\t\r\n\t\t}\r\n\r\n\t\tsetOGURL(enabled: boolean): UIRouterMetatags {\r\n\t\t\tthis.enableOGURL = enabled;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tpublic $get(): uiroutermetatags.IService {\r\n\t\t\treturn {\r\n\t\t\t\tprefix: this.prefix,\r\n\t\t\t\tsuffix: this.suffix,\r\n\t\t\t\tdefaultTitle: this.defaultTitle,\r\n\t\t\t\tdefaultDescription: this.defaultDescription,\r\n\t\t\t\tdefaultKeywords: this.defaultKeywords,\r\n\t\t\t\tstaticProperties: this.staticProperties,\r\n\t\t\t\tenableOGURL: this.enableOGURL\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tappModule.provider('UIRouterMetatags', UIRouterMetatags);\r\n\r\n\texport class MetaTags {\r\n\t\ttitle: string;\r\n\t\tkeywords: string;\r\n\t\tdescription: string;\r\n\t\tproperties: {};\r\n\t\tstdProperties: {};\r\n\t\tprerender: uiroutermetatags.Prerender = {};\r\n\t\t\r\n\t\t/* @ngInject */\r\n\t\tconstructor(public $log: angular.ILogService, public UIRouterMetatags: uiroutermetatags.IService, public $interpolate: angular.IInterpolateService, public $injector: angular.auto.IInjectorService, public $state: any, public $location: angular.ILocationService, public $window) {\r\n\t\t}\r\n\r\n\t\tupdate(tags: uiroutermetatags.IMetaTags) {\r\n\t\t\tthis.properties = this.UIRouterMetatags.staticProperties;\r\n\t\t\t\r\n\t\t\tif (this.UIRouterMetatags.enableOGURL) {\r\n\t\t\t\tthis.properties['og:url'] = this.$location.absUrl();\r\n\t\t\t}\r\n\r\n\t\t\tif (tags) {\r\n\t\t\t\tthis.title = tags.title ? this.UIRouterMetatags.prefix + (this.getValue(tags.title) || '') + this.UIRouterMetatags.suffix : this.UIRouterMetatags.defaultTitle;\r\n\t\t\t\tthis.description = tags.description ? this.getValue(tags.description) : this.UIRouterMetatags.defaultDescription;\r\n\t\t\t\tthis.keywords = tags.keywords ? this.getValue(tags.keywords) : this.UIRouterMetatags.defaultKeywords;\r\n\t\t\t\tangular.forEach(tags.properties, (value, key) => {\r\n\t\t\t\t\tvar v = this.getValue(value);\r\n\t\t\t\t\tif (v && v.trim().length > 0) {\r\n\t\t\t\t\t\tthis.properties[key] = v;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.title = this.UIRouterMetatags.defaultTitle;\r\n\t\t\t\tthis.description = this.UIRouterMetatags.defaultDescription;\r\n\t\t\t\tthis.keywords = this.UIRouterMetatags.defaultKeywords;\r\n\t\t\t}\r\n\t\t\tif (tags.prerender) {\r\n\t\t\t\tthis.prerender.statusCode = tags.prerender.statusCode ? this.getValue(tags.prerender.statusCode) : 200;\r\n\t\t\t\tthis.prerender.header = tags.prerender.header ? this.getValue(tags.prerender.header) : null;\r\n\t\t\t} else {\r\n\t\t\t\tthis.prerender.statusCode = 200;\r\n\t\t\t\tthis.prerender.header = null;\r\n\t\t\t}\r\n\r\n\t\t\tthis.$window.prerenderReady = true;\r\n\t\t}\r\n\r\n\t\tgetValue(tag) {\r\n\t\t\treturn Array.isArray(tag) ? this.$injector.invoke(tag, this, this.$state.$current.locals.globals) : this.$interpolate(tag)(this.$state.$current.locals.globals);\r\n\t\t}\r\n\t}\r\n\r\n\tappModule.service('MetaTags', MetaTags);\r\n\t\r\n\t/* @ngInject */\r\n\tfunction runBlock($log: angular.ILogService, $rootScope: any, MetaTags: uiroutermetatags.MetaTags, $window) {\r\n\t\t$rootScope.MetaTags = MetaTags;\r\n\r\n\t\t$rootScope.$on('$stateChangeStart', stateChangeStart);\r\n        $rootScope.$on('$stateChangeSuccess', stateChangeSuccess);\r\n        $rootScope.$on('$stateChangeError', stateChangeError);\r\n        $rootScope.$on('$stateNotFound', stateNotFound);\r\n\r\n\t\tfunction stateChangeStart(event: angular.IAngularEvent, toState: angular.ui.IState, toParams: any, from: angular.ui.IState, fromParams: any) {\r\n            $window.prerenderReady = false;\r\n\t\t}\r\n\r\n\t\tfunction stateChangeSuccess(event: angular.IAngularEvent, toState: any) {\r\n\t\t\tif (!toState.metaTags) {\r\n\t\t\t\t$log.debug(`MetaTags - route: \"${toState.name}\" does not contain any metatags`);\r\n\t\t\t}\r\n\t\t\tMetaTags.update(toState.metaTags);\r\n\t\t}\r\n\r\n\t\tfunction stateChangeError(event: angular.IAngularEvent, toState: angular.ui.IState, toParams: any, fromState: angular.ui.IState, fromParams: any, error: any) {\r\n\t\t\tMetaTags.prerender.statusCode = 500;\r\n\t\t\t$window.prerenderReady = true;\r\n\t\t}\r\n\r\n\t\tfunction stateNotFound(event: angular.IAngularEvent, unfoundState: angular.ui.IState, fromState: angular.ui.IState) {\r\n\t\t\tMetaTags.prerender.statusCode = 404;\r\n\t\t\t$window.prerenderReady = true;\r\n\t\t}\r\n\t}\r\n\r\n\tappModule.run(runBlock);\r\n\r\n}","var uiroutermetatags;\n(function (uiroutermetatags) {\n    var appModule = angular.module('ui.router.metatags', ['ui.router']);\n    var UIRouterMetatags = (function () {\n        /* @ngInject */\n        function UIRouterMetatags() {\n            this.prefix = '';\n            this.suffix = '';\n            this.defaultTitle = '';\n            this.defaultDescription = '';\n            this.defaultKeywords = '';\n            this.staticProperties = {};\n            this.enableOGURL = false;\n        }\n        UIRouterMetatags.prototype.setTitlePrefix = function (prefix) {\n            this.prefix = prefix;\n            return this;\n        };\n        UIRouterMetatags.prototype.setTitleSuffix = function (suffix) {\n            this.suffix = suffix;\n            return this;\n        };\n        UIRouterMetatags.prototype.setDefaultTitle = function (title) {\n            this.defaultTitle = title;\n            return this;\n        };\n        UIRouterMetatags.prototype.setDefaultDescription = function (description) {\n            this.defaultDescription = description;\n            return this;\n        };\n        UIRouterMetatags.prototype.setDefaultKeywords = function (keywords) {\n            this.defaultKeywords = keywords;\n            return this;\n        };\n        UIRouterMetatags.prototype.setStaticProperties = function (properties) {\n            this.staticProperties = properties;\n            return this;\n        };\n        UIRouterMetatags.prototype.setOGURL = function (enabled) {\n            this.enableOGURL = enabled;\n            return this;\n        };\n        UIRouterMetatags.prototype.$get = function () {\n            return {\n                prefix: this.prefix,\n                suffix: this.suffix,\n                defaultTitle: this.defaultTitle,\n                defaultDescription: this.defaultDescription,\n                defaultKeywords: this.defaultKeywords,\n                staticProperties: this.staticProperties,\n                enableOGURL: this.enableOGURL\n            };\n        };\n        return UIRouterMetatags;\n    })();\n    uiroutermetatags.UIRouterMetatags = UIRouterMetatags;\n    appModule.provider('UIRouterMetatags', UIRouterMetatags);\n    var MetaTags = (function () {\n        /* @ngInject */\n        function MetaTags($log, UIRouterMetatags, $interpolate, $injector, $state, $location, $window) {\n            this.$log = $log;\n            this.UIRouterMetatags = UIRouterMetatags;\n            this.$interpolate = $interpolate;\n            this.$injector = $injector;\n            this.$state = $state;\n            this.$location = $location;\n            this.$window = $window;\n            this.prerender = {};\n        }\n        MetaTags.$inject = [\"$log\", \"UIRouterMetatags\", \"$interpolate\", \"$injector\", \"$state\", \"$location\", \"$window\"];\n        MetaTags.prototype.update = function (tags) {\n            var _this = this;\n            this.properties = this.UIRouterMetatags.staticProperties;\n            if (this.UIRouterMetatags.enableOGURL) {\n                this.properties['og:url'] = this.$location.absUrl();\n            }\n            if (tags) {\n                this.title = tags.title ? this.UIRouterMetatags.prefix + (this.getValue(tags.title) || '') + this.UIRouterMetatags.suffix : this.UIRouterMetatags.defaultTitle;\n                this.description = tags.description ? this.getValue(tags.description) : this.UIRouterMetatags.defaultDescription;\n                this.keywords = tags.keywords ? this.getValue(tags.keywords) : this.UIRouterMetatags.defaultKeywords;\n                angular.forEach(tags.properties, function (value, key) {\n                    var v = _this.getValue(value);\n                    if (v && v.trim().length > 0) {\n                        _this.properties[key] = v;\n                    }\n                });\n            }\n            else {\n                this.title = this.UIRouterMetatags.defaultTitle;\n                this.description = this.UIRouterMetatags.defaultDescription;\n                this.keywords = this.UIRouterMetatags.defaultKeywords;\n            }\n            if (tags.prerender) {\n                this.prerender.statusCode = tags.prerender.statusCode ? this.getValue(tags.prerender.statusCode) : 200;\n                this.prerender.header = tags.prerender.header ? this.getValue(tags.prerender.header) : null;\n            }\n            else {\n                this.prerender.statusCode = 200;\n                this.prerender.header = null;\n            }\n            this.$window.prerenderReady = true;\n        };\n        MetaTags.prototype.getValue = function (tag) {\n            return Array.isArray(tag) ? this.$injector.invoke(tag, this, this.$state.$current.locals.globals) : this.$interpolate(tag)(this.$state.$current.locals.globals);\n        };\n        return MetaTags;\n    })();\n    uiroutermetatags.MetaTags = MetaTags;\n    appModule.service('MetaTags', MetaTags);\n    /* @ngInject */\n    function runBlock($log, $rootScope, MetaTags, $window) {\n        $rootScope.MetaTags = MetaTags;\n        $rootScope.$on('$stateChangeStart', stateChangeStart);\n        $rootScope.$on('$stateChangeSuccess', stateChangeSuccess);\n        $rootScope.$on('$stateChangeError', stateChangeError);\n        $rootScope.$on('$stateNotFound', stateNotFound);\n        function stateChangeStart(event, toState, toParams, from, fromParams) {\n            $window.prerenderReady = false;\n        }\n        function stateChangeSuccess(event, toState) {\n            if (!toState.metaTags) {\n                $log.debug(\"MetaTags - route: \\\"\" + toState.name + \"\\\" does not contain any metatags\");\n            }\n            MetaTags.update(toState.metaTags);\n        }\n        function stateChangeError(event, toState, toParams, fromState, fromParams, error) {\n            MetaTags.prerender.statusCode = 500;\n            $window.prerenderReady = true;\n        }\n        function stateNotFound(event, unfoundState, fromState) {\n            MetaTags.prerender.statusCode = 404;\n            $window.prerenderReady = true;\n        }\n    }\n    runBlock.$inject = [\"$log\", \"$rootScope\", \"MetaTags\", \"$window\"];\n    appModule.run(runBlock);\n})(uiroutermetatags || (uiroutermetatags = {}));\n\n//# sourceMappingURL=ui-router-metatags.js.map\n"],"sourceRoot":"/source/"}